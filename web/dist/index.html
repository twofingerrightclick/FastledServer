<!DOCTYPE html><html><head><meta charset="UTF-8"><title>DAS LEDZ</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous"></head><meta name="viewport" content="width=device-width,initial-scale=1"><body><div class="controls"><div><h7>Brightness - <span data-bind="text: brightness"></span></h7><div class="slidecontainer" style="width:60vw"><input type="range" min="5" max="250" value="5" class="slider" data-bind="value: brightness, valueUpdate: 'input'"></div></div><div class="container palette-controls" style="font-family:'Roboto Mono'"><div class="row"><div class="col" data-bind="with: palette"><table><thead><tr><th></th><th>color</th><th>anchor</th></tr></thead><tbody data-bind="foreach: colors"><tr><td data-bind="text: index"></td><td><input type="color" data-bind="value: hex"></td><td><input type="number" data-bind="value: anchorPoint" style="width:50px" min="0" max="255"></td><td><button type="button" data-bind="click: $parent.removeColor" class="btn btn-primary">-</button></td></tr></tbody></table><div class="btn-group"><button type="button" data-bind="click: addColor" class="btn btn-primary">+</button> <button type="button" data-bind="click: removeColor" class="btn btn-primary">-</button></div></div><div class="col"><div class="commands"><button class="btn btn-secondary btn-sm" data-bind="click: setSolidColor">Set Solid Color</button> <button class="btn btn-secondary btn-sm" data-bind="click: setGradient">Set Gradient</button> <button class="btn btn-secondary btn-sm" data-bind="click: flowPalette">Flow</button> <button class="btn btn-warning btn-sm" data-bind="click: setStopAnimations">Stop Animation</button></div></div></div><div><h7># of Colors to use from palette - <span data-bind="text: numbersOfColorsToUseFromPalette"></span></h7><div class="slidecontainer" style="width:60vw"><input type="range" min="0" step="1" class="slider" data-bind="value: numbersOfColorsToUseFromPaletteIndex, valueUpdate: 'input', attr: {max:  validNumbersOfColorsToUseFromPalette.length - 1}"></div></div><div><h7># of LEDS Per Palette Color - <span data-bind="text: numberOfLedsPerPaletteColor"></span></h7><div class="slidecontainer" style="width:60vw"><input type="range" min="1" value="5" class="slider" data-bind="value: numberOfLedsPerPaletteColor, valueUpdate: 'input', attr: {max: NUM_LEDS}"></div></div><div><h7>Speed - <span data-bind="text: speed"></span>ms</h7><div class="slidecontainer" style="width:60vw"><input type="range" min="1" max="1000" value="5" class="slider" data-bind="value: speed, valueUpdate: 'input'"></div></div><div style="flex-wrap:wrap;flex-direction:column;display:flex;margin-top:60px"><h7>ip of esp8266 server:</h7><input type="text" data-bind="value: serverAddress" style="width:10em"><h7># of leds</h7><input type="number" data-bind="value: numLedsInput" style="width:50px"></div><script async="false" defer="false">var Pattern,__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,i,a,l){return new(a=a||Promise)(function(r,t){function n(e){try{s(l.next(e))}catch(e){t(e)}}function o(e){try{s(l.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}s((l=l.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(r,n){var o,s,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,s&&(i=2&t[0]?s.return:t[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,t[1])).done)return i;switch(s=0,(t=i?[2&t[0],i.value]:t)[0]){case 0:case 1:i=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,s=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){a.label=t[1];break}if(6===t[0]&&a.label<i[1]){a.label=i[1],i=t;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(t);break}i[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],s=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__spreadArray=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},LedRemote=function(){var o=this;this.brightness=ko.observable(),this.speed=ko.observable(50),this.NUM_LEDS=ko.observable(50),this.numLedsInput=ko.observable("50"),this.numbersOfColorsToUseFromPaletteIndex=ko.observable(0),this.numbersOfColorsToUseFromPalette=ko.observable(256),this.numberOfLedsPerPaletteColor=ko.observable(5),this.palette=ko.observable(new Palette(function(e){return o.setGradient()},function(e){return o.setSolidColor()})),this.serverAddress=ko.observable(location.hostname),this.setStopAnimations=_.debounce(function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.none_,{})];case 1:return e.sent(),[2]}})})},50),this.setBrightness=_.debounce(function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.brightness_,{data:this.brightness()})];case 1:return e.sent(),[2]}})})},100),this.setGradientStep=_.debounce(function(){return __awaiter(o,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=Math.ceil(this.palette().NUM_COLORS_FASTLED_PALETTE/this.validNumbersOfColorsToUseFromPalette[this.numbersOfColorsToUseFromPaletteIndex()]),console.log(t),[4,this.post(Pattern.gradientStep_,{data:t})];case 1:return e.sent(),[2]}})})},100),this.setSpeed=_.debounce(function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.speed_,{data:this.speed()})];case 1:return e.sent(),[2]}})})},200),this.setNumberOfLedsPerPaletteColor=_.debounce(function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.numLedsPerPaletteColor_,{data:this.numberOfLedsPerPaletteColor()})];case 1:return e.sent(),[2]}})})},200),this.setSolidColor=function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.solidColor_,{data:this.palette().solidColor().rgb()})];case 1:return e.sent(),[2]}})})},this.setGradient=function(){return __awaiter(o,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this.palette().getPaletteRgbArray(),t={data:t,length:t.length},[4,this.post(Pattern.gradient_,t)];case 1:return e.sent(),[2]}})})},this.setRainbow=function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.rainbow_,{})];case 1:return e.sent(),[2]}})})},this.flowPalette=function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.post(Pattern.flowPalette_,{data:this.speed()})];case 1:return e.sent(),[2]}})})},this.getValidNumberOfColorsPerPalette=function(){for(var e=Number.MAX_SAFE_INTEGER,t=[],r=o.palette().NUM_COLORS_FASTLED_PALETTE;1<=r;r--){var n=Math.ceil(256/r);n!=e&&(t.push(n),e=n)}return t},this.post=function(t,r){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return r=__assign({type:t},r),[4,fetch("http://".concat(this.serverAddress(),"/post"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})];case 1:return e.sent(),[2]}})})},this.brightness.subscribe(this.setBrightness),this.numLedsInput.subscribe(function(){o.NUM_LEDS(Number.parseInt(o.numLedsInput())),console.log("numLeds: ".concat(o.NUM_LEDS()))}),this.speed.subscribe(this.setSpeed),this.numberOfLedsPerPaletteColor.subscribe(this.setNumberOfLedsPerPaletteColor),this.validNumbersOfColorsToUseFromPalette=this.getValidNumberOfColorsPerPalette(),this.numbersOfColorsToUseFromPaletteIndex(this.validNumbersOfColorsToUseFromPalette.length-1),this.numbersOfColorsToUseFromPalette(this.validNumbersOfColorsToUseFromPalette[this.validNumbersOfColorsToUseFromPalette.length-1]),this.numbersOfColorsToUseFromPaletteIndex.subscribe(this.setGradientStep),this.numbersOfColorsToUseFromPaletteIndex.subscribe(function(e){return o.numbersOfColorsToUseFromPalette(o.validNumbersOfColorsToUseFromPalette[e])})};!function(e){e[e.none_=0]="none_",e[e.solidColor_=1]="solidColor_",e[e.brightness_=2]="brightness_",e[e.gradient_=3]="gradient_",e[e.rainbow_=4]="rainbow_",e[e.flowPalette_=5]="flowPalette_",e[e.breathePalette_=6]="breathePalette_",e[e.speed_=7]="speed_",e[e.gradientStep_=8]="gradientStep_",e[e.numLedsPerPaletteColor_=9]="numLedsPerPaletteColor_"}(Pattern=Pattern||{});var Color=function(e){var t=this;void 0===e&&(e="#000000"),this.hex=ko.observable(),this.hsv=function(){return t.hex2hsv(t.hex())},this.rgb=function(){return t.hex2Rgb(t.hex())},this.hex2Rgb=function(e){e=e.substring(1,7);return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]},this.hex2hsv=function(e){var t=e.substring(1,7),r=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),r=parseInt((""+r).replace(/\s/g,""),10),n=parseInt((""+n).replace(/\s/g,""),10),o=parseInt((""+o).replace(/\s/g,""),10);if(null==r||null==n||null==o||isNaN(r)||isNaN(n)||isNaN(o))alert("Please enter numeric RGB values!");else{if(!(r<0||n<0||o<0||255<r||255<n||255<o)){r/=255,n/=255,o/=255;e=Math.min(r,Math.min(n,o)),t=Math.max(r,Math.max(n,o));return e==t?{h:0,s:0,v:e}:{h:60*((r==e?3:o==e?1:5)-(r==e?n-o:o==e?r-n:o-r)/(t-e)),s:(t-e)/t,v:t}}alert("RGB values must be in the range 0 to 255.")}},this.hex(e)},PaletteColor=function(o){function e(e,t,r){void 0===r&&(r=void 0);var n=o.call(this,t)||this;return n.getAnchorPoint=function(){return parseInt(n.anchorPoint())},n.anchorPoint=ko.observable(0),n.index=ko.observable(),n.onHexChange=ko.observable(function(e){}),n.index(e),r&&(n.onHexChange(r),n.hex.subscribe(n.onHexChange())),n}return __extends(e,o),e}(Color),Palette=function(e,t){var o=this;this.colors=ko.observableArray(),this.solidColor=ko.observable(),this.NUM_COLORS_FASTLED_PALETTE=256,this.newColor=function(){return ko.observable(new PaletteColor(o.colors().length,"#000000",o.onPaletteColorChange))},this.addColor=function(){o.colors().length<8&&(o.colors.push(o.newColor()),o.adjustAnchorPoints())},this.removeColor=function(t){1<o.colors().length&&(null!=t.index?o.colors.remove(function(e){return e().index==t.index}):o.colors.pop(),o.adjustAnchorPoints())},this.setSolidColor=function(e){e.onHexChange(o.onSolidColorChange),o.solidColor(e)},this.adjustIndexes=function(){for(var e=0;e<o.colors().length;e++)o.colors()[e]().index(e),0==e&&o.setSolidColor(o.colors()[e]())},this.adjustAnchorPoints=function(){o.adjustIndexes();var n=Math.floor(255/(o.colors().length-1));o.colors().forEach(function(e){var t=e(),r=0==t.index()?0:t.index()==o.colors().length-1?255:t.index()*n;t.anchorPoint(r),e(t)})},this.getHsvArray=function(){o.colors().length,o.colors().map(function(e){return e().hsv})},this.getPaletteRgbArray=function(){return t=new Array,o.colors().forEach(function(e){return t.push.apply(t,__spreadArray([e().getAnchorPoint()],e().rgb(),!1))}),t;var t},this.solidColor=ko.observable(new PaletteColor(0,"#000000",t)),this.colors.push(this.solidColor),this.onPaletteColorChange=e,this.onSolidColorChange=t},applyViewModel=function(){return ko.applyBindings(new LedRemote)},waitToApplyViewModel=function(){try{if(null!=_&&null!=ko)try{applyViewModel()}catch(e){console.error(e)}}catch(e){setTimeout(waitToApplyViewModel,200)}};waitToApplyViewModel()</script><script async="false" defer="false" id="knockout" src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.1/knockout-latest.min.js"></script><script async="false" defer="false" id="lodash" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script></div></div></body><style>.controls{font-family:'Roboto Mono',monospace;color:#fff;font-size:15px;margin:10px;padding:10px;display:flex;flex-direction:column;flex-wrap:wrap;justify-items:center;justify-content:flex-start}.controls>*{margin:15px 0 15px 0}.commands>*{margin:5px 5px 5px 5px}body{background-color:#131313}.title{margin:1px;margin-bottom:0}.palette-controls{margin-top:3px}.flex-button-container{display:flex;flex-direction:column;flex-wrap:wrap;justify-items:center;justify-content:flex-start}.flex-button-container>button{margin:3px}.slidecontainer{margin-top:5px}.slider{-webkit-appearance:none;width:100%;height:15px;border-radius:5px;background:#433a63;outline:0;opacity:.7;-webkit-transition:.2s;transition:opacity .2s}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:25px;height:25px;border-radius:50%;background:#20b8ff;cursor:pointer}.slider::-moz-range-thumb{width:25px;height:25px;border-radius:50%;background:#04aa6d;cursor:pointer}</style></html>